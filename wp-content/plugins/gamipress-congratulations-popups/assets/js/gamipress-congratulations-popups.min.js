!function(a){var t,n=[];function s(){var t=a(".gamipress-congratulations-popups-overlay");t.length||(a("body").append('<div class="gamipress-congratulations-popups-overlay" style="display: none;"></div>'),t=a(".gamipress-congratulations-popups-overlay")),setTimeout(function(){t.hasClass("active")||(t.addClass("active"),t.fadeIn(500));var o=a(".gamipress-congratulations-popup-wrapper").first(),p=o.attr("id");if(-1!==n.indexOf(p)){o.remove(),a(".gamipress-congratulations-popup-wrapper").length?s():(t.fadeOut(500),t.removeClass("active"));return}o.addClass("active");var i=o.data("show-sound");i.length&&e(i),o.fadeIn(500,function(){gamipress_congratulations_popups_show_effect(o)})},300)}function e(a){var t=a.split(/[\\\/]/).pop();if(void 0!==t){var n=a.match(/\.([^.]+)$/);if(null!==n){var s=n[1],e=t.replace(".","_"),p=document.getElementById(e);if(p){o(p);return}var i=document.createElement("source");i.src=a,i.type="audio/"+s,(p=document.createElement("audio")).id=e,p.appendChild(i),document.body.appendChild(p),o(p)}}}function o(a){a.currentTime=0,a.volume=1,a.load(),setTimeout(function(){a.play().catch(()=>{a.play().catch(()=>{})})},0)}function p(){if(void 0===t){var n=a(".gamipress-user-points").length;t=a.ajax({url:gamipress_congratulations_popups.ajaxurl,data:{action:"gamipress_congratulations_popups_get_popups",nonce:gamipress_congratulations_popups.nonce,user_points:n},success:function(e){var o;if(void 0!==e.data.popups&&e.data.popups.length){for(o=0;o<e.data.popups.length;o++){var p=e.data.popups[o];a("body").append(p)}s()}if(n&&e.data.user_points.length)for(o=0;o<e.data.user_points.length;o++){var i=e.data.user_points[o];a(".gamipress-user-points.gamipress-is-current-user .gamipress-user-points-"+i.points_type+" .gamipress-user-points-count").text(i.points)}t=void 0}})}}p(),a(document).ajaxSuccess(function(a,t,n){!function a(t,n){void 0===t&&(t=""),void 0===n&&(n=t),"string"!=typeof n&&(n=t);var s=!1;if(gamipress_congratulations_popups.excluded_urls.forEach(function(a){t.includes(a)&&(s=!0)}),s)return!0;var e=!1;if(gamipress_congratulations_popups.excluded_data.forEach(function(a){n.includes(a)&&(e=!0)}),e)return!0;if(t.includes("admin-ajax.php")){var o=!1;if(gamipress_congratulations_popups.excluded_ajax_actions.forEach(function(a){n.includes("action="+a)&&(o=!0)}),o)return!0}return!1}(n.url,n.data)&&200===parseInt(t.status)&&setTimeout(p,parseInt(gamipress_congratulations_popups.ajax_check_delay))}),a("body").on("click",".gamipress-congratulations-popup-close",function(){var t,o,p,i;t=a(".gamipress-congratulations-popup-wrapper.active"),o=a(".gamipress-congratulations-popups-overlay"),p=t.attr("id").replace("gamipress-congratulations-popup-display-",""),(i=t.data("hide-sound")).length&&e(i),t.fadeOut(500,function(){n.push(t.attr("id")),a(this).remove(),a(".gamipress-congratulations-popup-wrapper").length?setTimeout(function(){s()},500):(o.fadeOut(500),o.removeClass("active"))}),a.ajax({url:gamipress_congratulations_popups.ajaxurl,data:{action:"gamipress_congratulations_popups_popup_shown",nonce:gamipress_congratulations_popups.nonce,congratulations_popup_display_id:p},success:function(a){console.log(a)}})})}(jQuery);